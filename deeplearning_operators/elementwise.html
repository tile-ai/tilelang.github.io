<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="General Matrix-Vector Multiplication (GEMV)" href="gemv.html" /><link rel="prev" title="Pipelining Computation and Data Movement" href="../tutorials/pipelining_computations_and_data_movements.html" />

    <!-- Generated with Sphinx 5.2.3 and Furo 2023.03.27 -->
        <title>ElementWise Operators - Tile Language 0.1.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Tile Language <br> 0.1.5 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/img/logo-row.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/img/logo-row.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Tile Language <br> 0.1.5 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">GET STARTED</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/Installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/overview.html">The Tile Language: A Brief Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/writing_kernels_with_tilelibrary.html">Writing High-Performance Kernels with the Tile Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/writing_kernels_with_thread_primitives.html">Writing High-Performance Kernels with Thread Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/annotate_memory_layout.html">Annotate Memory Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/debug_tools_for_tilelang.html">Debugging Tile Language Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/auto_tuning.html">Auto-Tuning Techniques for Performance Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/jit_compilation.html">Just In Time Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/pipelining_computations_and_data_movements.html">Pipelining Computation and Data Movement</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEEP LEARNING OPERATORS</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">ElementWise Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="gemv.html">General Matrix-Vector Multiplication (GEMV)</a></li>
<li class="toctree-l1"><a class="reference internal" href="matmul.html">General Matrix-Matrix Multiplication with Tile Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="matmul_dequant.html">General Matrix-Matrix Multiplication with Dequantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="flash_attention.html">Flash Attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="flash_linear_attention.html">Flash Linear Attention</a></li>
<li class="toctree-l1"><a class="reference internal" href="deepseek_mla.html">ðŸš€ Write High Performance FlashMLA with TileLang on Hopper</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution.html">Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="tmac_gpu.html">TMAC: Look Up Table Based Mixed Precision Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LANGUAGE REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language_ref/ast.html">Tile Language AST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language_ref/primitives.html">Tile Language: Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language_ref/tilelibrary.html">Tile Language: TileLibrary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/modules.html">Python API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/tilelang.html">tilelang package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.autotuner.html">tilelang.autotuner package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.autotuner.param.html">tilelang.autotuner.param module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.cache.html">tilelang.cache package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.cache.kernel_cache.html">tilelang.cache.kernel_cache module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.cache.tuner_cache.html">tilelang.cache.tuner_cache module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.carver.html">tilelang.carver package</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.carver.arch.html">tilelang.carver.arch package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.carver.arch.driver.html">tilelang.carver.arch.driver package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.arch.driver.cuda_driver.html">tilelang.carver.arch.driver.cuda_driver module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.arch.arch_base.html">tilelang.carver.arch.arch_base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.arch.cdna.html">tilelang.carver.arch.cdna module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.arch.cpu.html">tilelang.carver.arch.cpu module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.arch.cuda.html">tilelang.carver.arch.cuda module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.carver.roller.html">tilelang.carver.roller package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.carver.roller.policy.html">tilelang.carver.roller.policy package</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.roller.policy.common.html">tilelang.carver.roller.policy.common module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.roller.policy.default.html">tilelang.carver.roller.policy.default module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.roller.policy.tensorcore.html">tilelang.carver.roller.policy.tensorcore module</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.carver.roller.shape_inference.html">tilelang.carver.roller.shape_inference package</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.roller.shape_inference.common.html">tilelang.carver.roller.shape_inference.common module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.carver.roller.shape_inference.tir.html">tilelang.carver.roller.shape_inference.tir module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.roller.bestfit.html">tilelang.carver.roller.bestfit module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.roller.hint.html">tilelang.carver.roller.hint module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.roller.node.html">tilelang.carver.roller.node module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.roller.rasterization.html">tilelang.carver.roller.rasterization module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.carver.template.html">tilelang.carver.template package</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.base.html">tilelang.carver.template.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.conv.html">tilelang.carver.template.conv module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.elementwise.html">tilelang.carver.template.elementwise module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.flashattention.html">tilelang.carver.template.flashattention module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.gemv.html">tilelang.carver.template.gemv module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.general_reduce.html">tilelang.carver.template.general_reduce module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.carver.template.matmul.html">tilelang.carver.template.matmul module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.carver.analysis.html">tilelang.carver.analysis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.carver.common_schedules.html">tilelang.carver.common_schedules module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.carver.matmul_analysis.html">tilelang.carver.matmul_analysis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.carver.utils.html">tilelang.carver.utils module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.common.html">tilelang.common package</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.common.transform_kind.html">tilelang.common.transform_kind module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.contrib.html">tilelang.contrib package</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.cc.html">tilelang.contrib.cc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.dlpack.html">tilelang.contrib.dlpack module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.hipcc.html">tilelang.contrib.hipcc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.nvcc.html">tilelang.contrib.nvcc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.nvrtc.html">tilelang.contrib.nvrtc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.contrib.rocm.html">tilelang.contrib.rocm module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.engine.html">tilelang.engine package</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.engine.callback.html">tilelang.engine.callback module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.engine.lower.html">tilelang.engine.lower module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.engine.param.html">tilelang.engine.param module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.engine.phase.html">tilelang.engine.phase module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.intrinsics.html">tilelang.intrinsics package</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.intrinsics.mfma_layout.html">tilelang.intrinsics.mfma_layout module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.intrinsics.mfma_macro_generator.html">tilelang.intrinsics.mfma_macro_generator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.intrinsics.mma_layout.html">tilelang.intrinsics.mma_layout module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.intrinsics.mma_macro_generator.html">tilelang.intrinsics.mma_macro_generator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.intrinsics.utils.html">tilelang.intrinsics.utils module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.jit.html">tilelang.jit package</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.jit.adapter.html">tilelang.jit.adapter package</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.jit.adapter.ctypes.html">tilelang.jit.adapter.ctypes package</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.jit.adapter.ctypes.adapter.html">tilelang.jit.adapter.ctypes.adapter module</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.jit.adapter.cython.html">tilelang.jit.adapter.cython package</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.jit.adapter.cython.adapter.html">tilelang.jit.adapter.cython.adapter module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.jit.adapter.cython.cython_wrapper.html">tilelang.jit.adapter.cython.cython_wrapper module</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../api/tilelang.jit.adapter.nvrtc.html">tilelang.jit.adapter.nvrtc package</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/tilelang.jit.adapter.nvrtc.adapter.html">tilelang.jit.adapter.nvrtc.adapter module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.jit.adapter.base.html">tilelang.jit.adapter.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.jit.adapter.dlpack.html">tilelang.jit.adapter.dlpack module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.jit.adapter.libgen.html">tilelang.jit.adapter.libgen module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.jit.adapter.utils.html">tilelang.jit.adapter.utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.jit.adapter.wrapper.html">tilelang.jit.adapter.wrapper module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.jit.env.html">tilelang.jit.env module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.jit.kernel.html">tilelang.jit.kernel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.jit.param.html">tilelang.jit.param module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.language.html">tilelang.language package</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.language.tir.html">tilelang.language.tir package</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.language.tir.entry.html">tilelang.language.tir.entry module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.language.tir.ir.html">tilelang.language.tir.ir module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.language.tir.op.html">tilelang.language.tir.op module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.allocate.html">tilelang.language.allocate module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.builtin.html">tilelang.language.builtin module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.copy.html">tilelang.language.copy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.customize.html">tilelang.language.customize module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.fill.html">tilelang.language.fill module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.frame.html">tilelang.language.frame module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.gemm.html">tilelang.language.gemm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.kernel.html">tilelang.language.kernel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.logical.html">tilelang.language.logical module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.memscope.html">tilelang.language.memscope module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.parallel.html">tilelang.language.parallel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.persistent.html">tilelang.language.persistent module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.pipeline.html">tilelang.language.pipeline module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.print.html">tilelang.language.print module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.proxy.html">tilelang.language.proxy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.reduce.html">tilelang.language.reduce module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.language.warpgroup.html">tilelang.language.warpgroup module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.layout.html">tilelang.layout package</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.layout.fragment.html">tilelang.layout.fragment module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.layout.layout.html">tilelang.layout.layout module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.layout.swizzle.html">tilelang.layout.swizzle module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/tilelang.math.html">tilelang.math package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.primitives.html">tilelang.primitives package</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../api/tilelang.primitives.gemm.html">tilelang.primitives.gemm package</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.primitives.gemm.base.html">tilelang.primitives.gemm.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../api/tilelang.primitives.gemm.gemm_mma.html">tilelang.primitives.gemm.gemm_mma module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.profiler.html">tilelang.profiler package</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.profiler.bench.html">tilelang.profiler.bench module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.quantize.html">tilelang.quantize package</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.quantize.lop3.html">tilelang.quantize.lop3 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.quantize.quantization.html">tilelang.quantize.quantization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.quantize.utils.html">tilelang.quantize.utils module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/tilelang.testing.html">tilelang.testing package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.tools.html">tilelang.tools package</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.tools.Analyzer.html">tilelang.tools.Analyzer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.tools.plot_layout.html">tilelang.tools.plot_layout module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.transform.html">tilelang.transform package</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.transform.pass_config.html">tilelang.transform.pass_config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.transform.simplify.html">tilelang.transform.simplify module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/tilelang.utils.html">tilelang.utils package</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.utils.deprecated.html">tilelang.utils.deprecated module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.utils.language.html">tilelang.utils.language module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.utils.target.html">tilelang.utils.target module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tilelang.utils.tensor.html">tilelang.utils.tensor module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/tilelang.env.html">tilelang.env module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../privacy.html">Privacy</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="elementwise-operators">
<h1>ElementWise Operators<a class="headerlink" href="#elementwise-operators" title="Permalink to this heading">#</a></h1>
<div style="text-align: left;">
    <em>Author:</em> <a href="https://github.com/chenghuaWang">Chenghua Wang</a>
</div>
<div class="myclass1 myclass2 admonition warning" id="a-tip-reference">
<p class="admonition-title">Warning</p>
<p>This document is still <strong>experimental</strong> and may be incomplete.<br />
Suggestions and improvements are highly encouragedâ€”please submit a PR!</p>
</div>
<p>Elementwise operators are widely used in deep learning and often serve as the first example encountered by those beginning to explore parallel programming. This tutorial will analyze several implementations of the elementwise addition operator using TileLang and compare them with the corresponding CUDA implementation. By the end of this tutorial, you will learn:</p>
<ol class="arabic simple">
<li><p>How to implement an elementwise operator using TileLang.</p></li>
<li><p>How to compile operators with dynamic shapes.</p></li>
<li><p>How TileLang addresses boundary-related issues.</p></li>
<li><p>The similarities and differences between operators implemented in TileLang and those implemented in CUDA/CuTe.</p></li>
</ol>
<p>Please note that this tutorial does not delve deeply into the design principles of TileLang. For a broader understanding of TileLang, we recommend consulting the <a class="reference internal" href="../get_started/overview.html"><span class="std std-doc">Overview</span></a>.</p>
<section id="elementwise-add-in-tilelang">
<h2>Elementwise add in TileLang<a class="headerlink" href="#elementwise-add-in-tilelang" title="Permalink to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
                <span class="n">C</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>All logic for TileLang kernels must be implemented within the <code class="docutils literal notranslate"><span class="pre">T.Kernel(...)</span></code> scope. In this example, initializing <code class="docutils literal notranslate"><span class="pre">T.kernel(...)</span></code> requires specifying both the grid size and the number of threads per block. The returned value <code class="docutils literal notranslate"><span class="pre">bx</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">blockIdx.x</span></code> in CUDA. In the provided implementation, <code class="docutils literal notranslate"><span class="pre">T.Parallel</span></code> is used to process the data tile (of size <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">threads</span></code>) assigned to the block for computation.</p>
<p>Those familiar with CUDA programming might wonder where <code class="docutils literal notranslate"><span class="pre">threadIdx</span></code> fits into this. Note that the code inside <code class="docutils literal notranslate"><span class="pre">T.Kernel</span></code> operates at the <strong>block level</strong>, not the <strong>thread level</strong>. In this example, your focus is solely on defining the block-level logic. During compilation, TileLang automatically maps computations to the corresponding threads and applies further optimizations. The optimized code generated by TileLang may closely align with carefully handcrafted computational logic, as demonstrated in Section 2 with a concrete example. While TileLang also supports thread-level programming semantics, this will be covered in subsequent discussions.</p>
<p>The program can be compiled using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">program</span> <span class="o">=</span> <span class="n">elementwise_add</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">tilelang</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">out_idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">execution_backend</span><span class="o">=</span><span class="s2">&quot;cython&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Launching the kernel is straightforward, just call it directly like a function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>The vector add operation can also be extended to two-dimensional cases, where both implementations demonstrate comparable efficiency in practice. Below is an example from the test section that readers can refer to: <a class="reference external" href="https://github.com/tile-ai/tilelang/blob/main/testing/python/kernel/test_tilelang_kernel_element_wise_add.py">example</a>. The code for this kernel is provided below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tilelang.language</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">T</span>
<span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">N</span><span class="p">,</span>
    <span class="n">block_M</span><span class="p">,</span>
    <span class="n">block_N</span><span class="p">,</span>
    <span class="n">in_dtype</span><span class="p">,</span>
    <span class="n">out_dtype</span><span class="p">,</span>
    <span class="n">threads</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
            <span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">in_dtype</span><span class="p">),</span>
            <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">in_dtype</span><span class="p">),</span>
            <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">out_dtype</span><span class="p">),</span>
    <span class="p">):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">block_N</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">block_M</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">bx</span><span class="p">,</span> <span class="n">by</span><span class="p">):</span>
            <span class="n">start_x</span> <span class="o">=</span> <span class="n">bx</span> <span class="o">*</span> <span class="n">block_N</span>
            <span class="n">start_y</span> <span class="o">=</span> <span class="n">by</span> <span class="o">*</span> <span class="n">block_M</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">local_y</span><span class="p">,</span> <span class="n">local_x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">block_M</span><span class="p">,</span> <span class="n">block_N</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">local_y</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">start_x</span> <span class="o">+</span> <span class="n">local_x</span>

                <span class="n">C</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<section id="how-to-compile-operators-with-dynamic-shapes">
<h3>How to compile operators with dynamic shapes?<a class="headerlink" href="#how-to-compile-operators-with-dynamic-shapes" title="Permalink to this heading">#</a></h3>
<p>In the compilation process above, a fixed shape was used. However, in practical usage, we often want the kernel to support dynamic shapes. So, how can we compile a kernel in TileLang to handle dynamic shapes? In TileLang, we can replace the target size with a dynamic symbolic value, making the dimension dynamic. The following example illustrates this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">program</span> <span class="o">=</span> <span class="n">elementwise_add</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">symbolic</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">tilelang</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">out_idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">execution_backend</span><span class="o">=</span><span class="s2">&quot;cython&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting CUDA code for the kernel will include an additional <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">N</span></code> parameter after the <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">C</span></code> parameters.</p>
</section>
<section id="how-tilelang-addresses-boundary-related-issues">
<h3>How TileLang addresses boundary-related issues.<a class="headerlink" href="#how-tilelang-addresses-boundary-related-issues" title="Permalink to this heading">#</a></h3>
<p>TileLang automatically incorporates boundary-checking conditions; however, this comes at a cost. These boundary conditions may prevent TileLang from performing more advanced optimizations. I will introduce an example from the next section in advance. The corresponding code is also provided below, but note that it involves the associated CUDA code. Readers are encouraged to first review the next section before returning to this paragraph for a clearer understanding.</p>
<p>When compiling the example below, letâ€™s set <code class="docutils literal notranslate"><span class="pre">N</span></code> to 2047:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">num_per_thread</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="p">):</span>
                <span class="n">offsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_per_thread</span>
                <span class="n">C</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>TileLang will generate the following CUDA code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cp">#pragma unroll</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2047</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">C</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can observe that TileLang did not apply optimizations such as vectorization or coalesced memory access. In fact, except for the tail group of data, all other threads could have executed more optimized code.</p>
</section>
</section>
<section id="comparison-of-tilelang-cuda-and-cute">
<h2>Comparison of TileLang, CUDA, and CuTe<a class="headerlink" href="#comparison-of-tilelang-cuda-and-cute" title="Permalink to this heading">#</a></h2>
<p>For the subsequent examples, this tutorial will use the vector add operation for simplicity and brevity.</p>
<p>Typically, those new to CUDA programming often write CUDA code in a style similar to this:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// vector add</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">elementwise_add</span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">c</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code above assigns each thread to compute a single element, which is evidently inefficient since common acceleration techniques like coalesced memory access and vectorization are not utilized. However, TileLang code written with similar logic (e.g., loop-based traversal) can be optimized by the compiler into highly efficient implementations, making it more accessible for beginners. Additionally, the final generated code from the compiler remains observable, providing transparency into the optimization process.</p>
<p>The CUDA code generated by TileLang for the compiled kernel can be retrieved using the <code class="docutils literal notranslate"><span class="pre">kernel.get_kernel_source()</span></code> method. Below is the CUDA code produced for the vector addition example from Section 1:</p>
<div class="highlight-cu notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">      </span><span class="kt">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">      </span><span class="kt">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the code above, TileLang not only automatically maps block-level parallelism to threads but also applies optimizations such as vectorization and coalesced memory access.</p>
<p>While TileLang incorporates various optimizations for the aforementioned case, its behavior may sometimes appear counterintuitive. For example, when targeting 256 threads for task processing, applying vectorization can result in each thread computing 8 data elementsâ€”effectively utilizing only 32 active threads. Interestingly, the kernel launch configuration still retains the original allocation of 256 threads.</p>
<p>In such scenarios, explicitly specifying the number of elements computed per thread can help â€œguideâ€ TileLangâ€™s code generation process, leading to implementations that are more closely aligned with the intended design.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">num_per_thread</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="p">):</span>
                <span class="n">offsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_per_thread</span>
                <span class="n">C</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>The corresponding CUDA code generated for the above example is presented below:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">));</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">));</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Aha, this CUDA code aligns closely with conventional programming practices, making it more familiar and intuitive.</p>
<p>But what happens if we provide additional hints to TileLang? For instance, by explicitly specifying register copies using the <code class="docutils literal notranslate"><span class="pre">T.copy(...)</span></code> operation. The example below demonstrates a vector addition implementation. Unlike the previous examples, this code explicitly loads data into registers before performing computations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="n">A_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="n">B_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="n">C_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>

            <span class="n">s_start</span> <span class="o">=</span> <span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span>
            <span class="n">s_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span>

            <span class="c1"># LDG. 128</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">A</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
                <span class="n">A_register</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">B</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
                <span class="n">B_register</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">):</span>
                <span class="n">C_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">A_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">B_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span>

            <span class="c1"># STG. 128</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">C_register</span><span class="p">,</span>
                <span class="n">C</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>In the example above, each thread is responsible for computing 8 elements. The <code class="docutils literal notranslate"><span class="pre">T.copy(...)</span></code> method functions at the block level, and TileLang automatically maps data movement operations to individual threads. This design may resonate more intuitively with CUDA developers. Let us now analyze the CUDA code generated from this implementation.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// N is set to 8192 * 8192 when compiling</span>
<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bfloat16_t</span><span class="w"> </span><span class="n">A_register</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="n">bfloat16_t</span><span class="w"> </span><span class="n">B_register</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">  </span><span class="n">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We observed the emergence of two additional registers, <code class="docutils literal notranslate"><span class="pre">A_register</span></code> and <code class="docutils literal notranslate"><span class="pre">B_register</span></code>. However, during the actual computation, these registers are simply reassigned to <code class="docutils literal notranslate"><span class="pre">v_</span></code> and <code class="docutils literal notranslate"><span class="pre">v__1</span></code>, respectively.</p>
<p>To evaluate complexity, one could implement the same elementwise addition operator using CuTe and compare it with the TileLang version. The corresponding CuTe code is provided below:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">=</span><span class="mi">8</span><span class="o">&gt;</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">elementwise_add</span><span class="p">(</span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cute</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">B</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_C_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_C</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_A_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_A</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_B_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_B</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_A_tile</span><span class="p">);</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_B_tile</span><span class="p">);</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_C_tile</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// LDG. 128</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">t_A_tile</span><span class="p">,</span><span class="w"> </span><span class="n">reg_buffer_A</span><span class="p">);</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">t_B_tile</span><span class="p">,</span><span class="w"> </span><span class="n">reg_buffer_B</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_C_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_C</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_A_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_A</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_B_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_B</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Perform vectorized addition</span>
<span class="cp">#pragma unroll</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vec_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">vec_idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">reg_C_vector</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">reg_C_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg_A_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">reg_B_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_C_flat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_C_vector</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// STG. 128</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">reg_C_flat</span><span class="p">,</span><span class="w"> </span><span class="n">t_C_tile</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>This tutorial showcases the implementation of the elementwise addition operator using TileLang, while also comparing various design approaches. TileLang significantly reduces the complexity of CUDA programming, enabling high performance with minimal code. Nevertheless, working with TileLang demands careful attention to specific implementation details. To ensure computational efficiency, it is essential to thoroughly examine the generated CUDA kernels.</p>
<hr class="docutils" />
<p><strong>Reference:</strong></p>
<p>[1] The CuTe code implementation draws inspiration from the techniques discussed in this blog: https://zhuanlan.zhihu.com/p/690703999</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gemv.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">General Matrix-Vector Multiplication (GEMV)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorials/pipelining_computations_and_data_movements.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Pipelining Computation and Data Movement</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025-2025, Tile Lang Contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ElementWise Operators</a><ul>
<li><a class="reference internal" href="#elementwise-add-in-tilelang">Elementwise add in TileLang</a><ul>
<li><a class="reference internal" href="#how-to-compile-operators-with-dynamic-shapes">How to compile operators with dynamic shapes?</a></li>
<li><a class="reference internal" href="#how-tilelang-addresses-boundary-related-issues">How TileLang addresses boundary-related issues.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-of-tilelang-cuda-and-cute">Comparison of TileLang, CUDA, and CuTe</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>