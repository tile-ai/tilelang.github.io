<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="General Matrix-Vector Multiplication (GEMV)" href="gemv.html"><link rel="prev" title="Auto-Tuning Techniques for Performance Optimization" href="../tutorials/auto_tuning.html">
        <link rel="prefetch" href="../_static/img/logo-row.svg" as="image">
        <link rel="prefetch" href="../_static/img/logo-row.svg" as="image">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>ElementWise Operators - Tile Language 0.1.6.post1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Tile Language <br> 0.1.6.post1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/img/logo-row.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/img/logo-row.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Tile Language <br> 0.1.6.post1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">GET STARTED</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/Installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/overview.html">The Tile Language: A Brief Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/debug_tools_for_tilelang.html">Debugging Tile Language Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/auto_tuning.html">Auto-Tuning Techniques for Performance Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEEP LEARNING OPERATORS</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">ElementWise Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="gemv.html">General Matrix-Vector Multiplication (GEMV)</a></li>
<li class="toctree-l1"><a class="reference internal" href="matmul.html">General Matrix-Matrix Multiplication with Tile Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="deepseek_mla.html">🚀 Write High Performance FlashMLA with TileLang on Hopper</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../autoapi/tilelang/index.html">tilelang</a><input aria-label="Toggle navigation of tilelang" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/autotuner/index.html">tilelang.autotuner</a><input aria-label="Toggle navigation of tilelang.autotuner" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/autotuner/capture/index.html">tilelang.autotuner.capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/autotuner/param/index.html">tilelang.autotuner.param</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/autotuner/tuner/index.html">tilelang.autotuner.tuner</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/cache/index.html">tilelang.cache</a><input aria-label="Toggle navigation of tilelang.cache" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/cache/kernel_cache/index.html">tilelang.cache.kernel_cache</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/index.html">tilelang.carver</a><input aria-label="Toggle navigation of tilelang.carver" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/carver/analysis/index.html">tilelang.carver.analysis</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/arch/index.html">tilelang.carver.arch</a><input aria-label="Toggle navigation of tilelang.carver.arch" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/arch/arch_base/index.html">tilelang.carver.arch.arch_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/arch/cdna/index.html">tilelang.carver.arch.cdna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/arch/cpu/index.html">tilelang.carver.arch.cpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/arch/cuda/index.html">tilelang.carver.arch.cuda</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/arch/driver/index.html">tilelang.carver.arch.driver</a><input aria-label="Toggle navigation of tilelang.carver.arch.driver" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/arch/driver/cuda_driver/index.html">tilelang.carver.arch.driver.cuda_driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/carver/common_schedules/index.html">tilelang.carver.common_schedules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/carver/matmul_analysis/index.html">tilelang.carver.matmul_analysis</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/roller/index.html">tilelang.carver.roller</a><input aria-label="Toggle navigation of tilelang.carver.roller" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/roller/bestfit/index.html">tilelang.carver.roller.bestfit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/roller/hint/index.html">tilelang.carver.roller.hint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/roller/node/index.html">tilelang.carver.roller.node</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/roller/policy/index.html">tilelang.carver.roller.policy</a><input aria-label="Toggle navigation of tilelang.carver.roller.policy" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/roller/policy/common/index.html">tilelang.carver.roller.policy.common</a></li>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/roller/policy/default/index.html">tilelang.carver.roller.policy.default</a></li>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/roller/policy/tensorcore/index.html">tilelang.carver.roller.policy.tensorcore</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/roller/rasterization/index.html">tilelang.carver.roller.rasterization</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/roller/shape_inference/index.html">tilelang.carver.roller.shape_inference</a><input aria-label="Toggle navigation of tilelang.carver.roller.shape_inference" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/roller/shape_inference/common/index.html">tilelang.carver.roller.shape_inference.common</a></li>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/carver/roller/shape_inference/tir/index.html">tilelang.carver.roller.shape_inference.tir</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/carver/template/index.html">tilelang.carver.template</a><input aria-label="Toggle navigation of tilelang.carver.template" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/base/index.html">tilelang.carver.template.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/conv/index.html">tilelang.carver.template.conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/elementwise/index.html">tilelang.carver.template.elementwise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/flashattention/index.html">tilelang.carver.template.flashattention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/gemv/index.html">tilelang.carver.template.gemv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/general_reduce/index.html">tilelang.carver.template.general_reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/carver/template/matmul/index.html">tilelang.carver.template.matmul</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/carver/utils/index.html">tilelang.carver.utils</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/common/index.html">tilelang.common</a><input aria-label="Toggle navigation of tilelang.common" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/common/transform_kind/index.html">tilelang.common.transform_kind</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/contrib/index.html">tilelang.contrib</a><input aria-label="Toggle navigation of tilelang.contrib" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/cc/index.html">tilelang.contrib.cc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/dlpack/index.html">tilelang.contrib.dlpack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/hipcc/index.html">tilelang.contrib.hipcc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/nvcc/index.html">tilelang.contrib.nvcc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/nvrtc/index.html">tilelang.contrib.nvrtc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/contrib/rocm/index.html">tilelang.contrib.rocm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/engine/index.html">tilelang.engine</a><input aria-label="Toggle navigation of tilelang.engine" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/engine/callback/index.html">tilelang.engine.callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/engine/lower/index.html">tilelang.engine.lower</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/engine/param/index.html">tilelang.engine.param</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/engine/phase/index.html">tilelang.engine.phase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../autoapi/tilelang/env/index.html">tilelang.env</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/intrinsics/index.html">tilelang.intrinsics</a><input aria-label="Toggle navigation of tilelang.intrinsics" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/intrinsics/mfma_layout/index.html">tilelang.intrinsics.mfma_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/intrinsics/mfma_macro_generator/index.html">tilelang.intrinsics.mfma_macro_generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/intrinsics/mma_layout/index.html">tilelang.intrinsics.mma_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/intrinsics/mma_macro_generator/index.html">tilelang.intrinsics.mma_macro_generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/intrinsics/utils/index.html">tilelang.intrinsics.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../autoapi/tilelang/ir/index.html">tilelang.ir</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/jit/index.html">tilelang.jit</a><input aria-label="Toggle navigation of tilelang.jit" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/index.html">tilelang.jit.adapter</a><input aria-label="Toggle navigation of tilelang.jit.adapter" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/base/index.html">tilelang.jit.adapter.base</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/ctypes/index.html">tilelang.jit.adapter.ctypes</a><input aria-label="Toggle navigation of tilelang.jit.adapter.ctypes" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/ctypes/adapter/index.html">tilelang.jit.adapter.ctypes.adapter</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/cython/index.html">tilelang.jit.adapter.cython</a><input aria-label="Toggle navigation of tilelang.jit.adapter.cython" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/cython/adapter/index.html">tilelang.jit.adapter.cython.adapter</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/dlpack/index.html">tilelang.jit.adapter.dlpack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/libgen/index.html">tilelang.jit.adapter.libgen</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/nvrtc/index.html">tilelang.jit.adapter.nvrtc</a><input aria-label="Toggle navigation of tilelang.jit.adapter.nvrtc" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/nvrtc/adapter/index.html">tilelang.jit.adapter.nvrtc.adapter</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/utils/index.html">tilelang.jit.adapter.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/jit/adapter/wrapper/index.html">tilelang.jit.adapter.wrapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/jit/env/index.html">tilelang.jit.env</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/jit/kernel/index.html">tilelang.jit.kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/jit/param/index.html">tilelang.jit.param</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/language/index.html">tilelang.language</a><input aria-label="Toggle navigation of tilelang.language" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/allocate/index.html">tilelang.language.allocate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/atomic/index.html">tilelang.language.atomic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/builtin/index.html">tilelang.language.builtin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/copy/index.html">tilelang.language.copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/customize/index.html">tilelang.language.customize</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/language/experimental/index.html">tilelang.language.experimental</a><input aria-label="Toggle navigation of tilelang.language.experimental" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/language/experimental/gemm_sp/index.html">tilelang.language.experimental.gemm_sp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/fill/index.html">tilelang.language.fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/frame/index.html">tilelang.language.frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/gemm/index.html">tilelang.language.gemm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/kernel/index.html">tilelang.language.kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/logical/index.html">tilelang.language.logical</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/parallel/index.html">tilelang.language.parallel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/persistent/index.html">tilelang.language.persistent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/pipeline/index.html">tilelang.language.pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/print/index.html">tilelang.language.print</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/proxy/index.html">tilelang.language.proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/reduce/index.html">tilelang.language.reduce</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/language/tir/index.html">tilelang.language.tir</a><input aria-label="Toggle navigation of tilelang.language.tir" class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/language/tir/entry/index.html">tilelang.language.tir.entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/language/tir/ir/index.html">tilelang.language.tir.ir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/language/tir/op/index.html">tilelang.language.tir.op</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/utils/index.html">tilelang.language.utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/language/warpgroup/index.html">tilelang.language.warpgroup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/layout/index.html">tilelang.layout</a><input aria-label="Toggle navigation of tilelang.layout" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/layout/fragment/index.html">tilelang.layout.fragment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/layout/gemm_sp/index.html">tilelang.layout.gemm_sp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/layout/layout/index.html">tilelang.layout.layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/layout/swizzle/index.html">tilelang.layout.swizzle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../autoapi/tilelang/math/index.html">tilelang.math</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/primitives/index.html">tilelang.primitives</a><input aria-label="Toggle navigation of tilelang.primitives" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/primitives/gemm/index.html">tilelang.primitives.gemm</a><input aria-label="Toggle navigation of tilelang.primitives.gemm" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/primitives/gemm/base/index.html">tilelang.primitives.gemm.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/primitives/gemm/gemm_mma/index.html">tilelang.primitives.gemm.gemm_mma</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/profiler/index.html">tilelang.profiler</a><input aria-label="Toggle navigation of tilelang.profiler" class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/profiler/bench/index.html">tilelang.profiler.bench</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/quantize/index.html">tilelang.quantize</a><input aria-label="Toggle navigation of tilelang.quantize" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/quantize/lop3/index.html">tilelang.quantize.lop3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/quantize/mxfp/index.html">tilelang.quantize.mxfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/quantize/quantization/index.html">tilelang.quantize.quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/quantize/utils/index.html">tilelang.quantize.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../autoapi/tilelang/testing/index.html">tilelang.testing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/tileop/index.html">tilelang.tileop</a><input aria-label="Toggle navigation of tilelang.tileop" class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/tilelang/tileop/gemm/index.html">tilelang.tileop.gemm</a><input aria-label="Toggle navigation of tilelang.tileop.gemm" class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/tileop/gemm/gemm_base/index.html">tilelang.tileop.gemm.gemm_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/tilelang/tileop/gemm/gemm_mma/index.html">tilelang.tileop.gemm.gemm_mma</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/tools/index.html">tilelang.tools</a><input aria-label="Toggle navigation of tilelang.tools" class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/tools/Analyzer/index.html">tilelang.tools.Analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/tools/plot_layout/index.html">tilelang.tools.plot_layout</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/transform/index.html">tilelang.transform</a><input aria-label="Toggle navigation of tilelang.transform" class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/transform/add_bufstore_wrapper/index.html">tilelang.transform.add_bufstore_wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/transform/pass_config/index.html">tilelang.transform.pass_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/transform/simplify/index.html">tilelang.transform.simplify</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/tilelang/utils/index.html">tilelang.utils</a><input aria-label="Toggle navigation of tilelang.utils" class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/utils/deprecated/index.html">tilelang.utils.deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/utils/language/index.html">tilelang.utils.language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/utils/sparse/index.html">tilelang.utils.sparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/utils/target/index.html">tilelang.utils.target</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/tilelang/utils/tensor/index.html">tilelang.utils.tensor</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../privacy.html">Privacy</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/deeplearning_operators/elementwise.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="elementwise-operators">
<h1>ElementWise Operators<a class="headerlink" href="#elementwise-operators" title="Link to this heading">¶</a></h1>
<div style="text-align: left;">
    <em>Author:</em> <a href="https://github.com/chenghuaWang">Chenghua Wang</a>
</div>
<div class="myclass1 myclass2 admonition warning" id="a-tip-reference">
<p class="admonition-title">Warning</p>
<p>This document is still <strong>experimental</strong> and may be incomplete.<br />
Suggestions and improvements are highly encouraged—please submit a PR!</p>
</div>
<p>Elementwise operators are widely used in deep learning and often serve as the first example encountered by those beginning to explore parallel programming. This tutorial will analyze several implementations of the elementwise addition operator using TileLang and compare them with the corresponding CUDA implementation. By the end of this tutorial, you will learn:</p>
<ol class="arabic simple">
<li><p>How to implement an elementwise operator using TileLang.</p></li>
<li><p>How to compile operators with dynamic shapes.</p></li>
<li><p>How TileLang addresses boundary-related issues.</p></li>
<li><p>The similarities and differences between operators implemented in TileLang and those implemented in CUDA/CuTe.</p></li>
</ol>
<p>Please note that this tutorial does not delve deeply into the design principles of TileLang. For a broader understanding of TileLang, we recommend consulting the <a class="reference internal" href="../get_started/overview.html"><span class="std std-doc">Overview</span></a>.</p>
<section id="elementwise-add-in-tilelang">
<h2>Elementwise add in TileLang<a class="headerlink" href="#elementwise-add-in-tilelang" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
                <span class="n">C</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>All logic for TileLang kernels must be implemented within the <code class="docutils literal notranslate"><span class="pre">T.Kernel(...)</span></code> scope. In this example, initializing <code class="docutils literal notranslate"><span class="pre">T.kernel(...)</span></code> requires specifying both the grid size and the number of threads per block. The returned value <code class="docutils literal notranslate"><span class="pre">bx</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">blockIdx.x</span></code> in CUDA. In the provided implementation, <code class="docutils literal notranslate"><span class="pre">T.Parallel</span></code> is used to process the data tile (of size <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">threads</span></code>) assigned to the block for computation.</p>
<p>Those familiar with CUDA programming might wonder where <code class="docutils literal notranslate"><span class="pre">threadIdx</span></code> fits into this. Note that the code inside <code class="docutils literal notranslate"><span class="pre">T.Kernel</span></code> operates at the <strong>block level</strong>, not the <strong>thread level</strong>. In this example, your focus is solely on defining the block-level logic. During compilation, TileLang automatically maps computations to the corresponding threads and applies further optimizations. The optimized code generated by TileLang may closely align with carefully handcrafted computational logic, as demonstrated in Section 2 with a concrete example. While TileLang also supports thread-level programming semantics, this will be covered in subsequent discussions.</p>
<p>The program can be compiled using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">program</span> <span class="o">=</span> <span class="n">elementwise_add</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">tilelang</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">out_idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">execution_backend</span><span class="o">=</span><span class="s2">&quot;cython&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Launching the kernel is straightforward, just call it directly like a function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>The vector add operation can also be extended to two-dimensional cases, where both implementations demonstrate comparable efficiency in practice. Below is an example from the test section that readers can refer to: <a class="reference external" href="https://github.com/tile-ai/tilelang/blob/main/testing/python/kernel/test_tilelang_kernel_element_wise_add.py">example</a>. The code for this kernel is provided below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tilelang.language</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">T</span>
<span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">N</span><span class="p">,</span>
    <span class="n">block_M</span><span class="p">,</span>
    <span class="n">block_N</span><span class="p">,</span>
    <span class="n">in_dtype</span><span class="p">,</span>
    <span class="n">out_dtype</span><span class="p">,</span>
    <span class="n">threads</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
            <span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">in_dtype</span><span class="p">),</span>
            <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">in_dtype</span><span class="p">),</span>
            <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">out_dtype</span><span class="p">),</span>
    <span class="p">):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">block_N</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">block_M</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">bx</span><span class="p">,</span> <span class="n">by</span><span class="p">):</span>
            <span class="n">start_x</span> <span class="o">=</span> <span class="n">bx</span> <span class="o">*</span> <span class="n">block_N</span>
            <span class="n">start_y</span> <span class="o">=</span> <span class="n">by</span> <span class="o">*</span> <span class="n">block_M</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">local_y</span><span class="p">,</span> <span class="n">local_x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">block_M</span><span class="p">,</span> <span class="n">block_N</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">local_y</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">start_x</span> <span class="o">+</span> <span class="n">local_x</span>

                <span class="n">C</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<section id="how-to-compile-operators-with-dynamic-shapes">
<h3>How to compile operators with dynamic shapes?<a class="headerlink" href="#how-to-compile-operators-with-dynamic-shapes" title="Link to this heading">¶</a></h3>
<p>In the compilation process above, a fixed shape was used. However, in practical usage, we often want the kernel to support dynamic shapes. So, how can we compile a kernel in TileLang to handle dynamic shapes? In TileLang, we can replace the target size with a dynamic symbolic value, making the dimension dynamic. The following example illustrates this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">program</span> <span class="o">=</span> <span class="n">elementwise_add</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">symbolic</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">tilelang</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">out_idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">execution_backend</span><span class="o">=</span><span class="s2">&quot;cython&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting CUDA code for the kernel will include an additional <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">N</span></code> parameter after the <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">bfloat16_t*</span> <span class="pre">__restrict__</span> <span class="pre">C</span></code> parameters.</p>
</section>
<section id="how-tilelang-addresses-boundary-related-issues">
<h3>How TileLang addresses boundary-related issues.<a class="headerlink" href="#how-tilelang-addresses-boundary-related-issues" title="Link to this heading">¶</a></h3>
<p>TileLang automatically incorporates boundary-checking conditions; however, this comes at a cost. These boundary conditions may prevent TileLang from performing more advanced optimizations. I will introduce an example from the next section in advance. The corresponding code is also provided below, but note that it involves the associated CUDA code. Readers are encouraged to first review the next section before returning to this paragraph for a clearer understanding.</p>
<p>When compiling the example below, let’s set <code class="docutils literal notranslate"><span class="pre">N</span></code> to 2047:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">num_per_thread</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="p">):</span>
                <span class="n">offsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_per_thread</span>
                <span class="n">C</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>TileLang will generate the following CUDA code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cp">#pragma unroll</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2047</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">C</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[((</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">))]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can observe that TileLang did not apply optimizations such as vectorization or coalesced memory access. In fact, except for the tail group of data, all other threads could have executed more optimized code.</p>
</section>
</section>
<section id="comparison-of-tilelang-cuda-and-cute">
<h2>Comparison of TileLang, CUDA, and CuTe<a class="headerlink" href="#comparison-of-tilelang-cuda-and-cute" title="Link to this heading">¶</a></h2>
<p>For the subsequent examples, this tutorial will use the vector add operation for simplicity and brevity.</p>
<p>Typically, those new to CUDA programming often write CUDA code in a style similar to this:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// vector add</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">elementwise_add</span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">c</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code above assigns each thread to compute a single element, which is evidently inefficient since common acceleration techniques like coalesced memory access and vectorization are not utilized. However, TileLang code written with similar logic (e.g., loop-based traversal) can be optimized by the compiler into highly efficient implementations, making it more accessible for beginners. Additionally, the final generated code from the compiler remains observable, providing transparency into the optimization process.</p>
<p>The CUDA code generated by TileLang for the compiled kernel can be retrieved using the <code class="docutils literal notranslate"><span class="pre">kernel.get_kernel_source()</span></code> method. Below is the CUDA code produced for the vector addition example from Section 1:</p>
<div class="highlight-cu notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="kt">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">      </span><span class="kt">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">      </span><span class="kt">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">      </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="nb">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the code above, TileLang not only automatically maps block-level parallelism to threads but also applies optimizations such as vectorization and coalesced memory access.</p>
<p>While TileLang incorporates various optimizations for the aforementioned case, its behavior may sometimes appear counterintuitive. For example, when targeting 256 threads for task processing, applying vectorization can result in each thread computing 8 data elements—effectively utilizing only 32 active threads. Interestingly, the kernel launch configuration still retains the original allocation of 256 threads.</p>
<p>In such scenarios, explicitly specifying the number of elements computed per thread can help “guide” TileLang’s code generation process, leading to implementations that are more closely aligned with the intended design.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">num_per_thread</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">num_per_thread</span><span class="p">):</span>
                <span class="n">offsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_per_thread</span>
                <span class="n">C</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">offsets</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>The corresponding CUDA code generated for the above example is presented below:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">));</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">));</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Aha, this CUDA code aligns closely with conventional programming practices, making it more familiar and intuitive.</p>
<p>But what happens if we provide additional hints to TileLang? For instance, by explicitly specifying register copies using the <code class="docutils literal notranslate"><span class="pre">T.copy(...)</span></code> operation. The example below demonstrates a vector addition implementation. Unlike the previous examples, this code explicitly loads data into registers before performing computations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">elementwise_add</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bfloat16&quot;</span><span class="p">):</span>

    <span class="nd">@T</span><span class="o">.</span><span class="n">prim_func</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">B</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">C</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">Tensor</span><span class="p">((</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">T</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">b_x</span><span class="p">):</span>
            <span class="n">A_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="n">B_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
            <span class="n">C_register</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">alloc_fragment</span><span class="p">((</span><span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>

            <span class="n">s_start</span> <span class="o">=</span> <span class="n">b_x</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span>
            <span class="n">s_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">threads</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span>

            <span class="c1"># LDG. 128</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">A</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
                <span class="n">A_register</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">B</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
                <span class="n">B_register</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># vector add.</span>
            <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">threads</span><span class="p">,</span> <span class="n">NUM_ELE_PER_THREAD</span><span class="p">):</span>
                <span class="n">C_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">A_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">B_register</span><span class="p">[</span><span class="n">tid</span> <span class="o">*</span> <span class="n">NUM_ELE_PER_THREAD</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span>

            <span class="c1"># STG. 128</span>
            <span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">C_register</span><span class="p">,</span>
                <span class="n">C</span><span class="p">[</span><span class="n">s_start</span><span class="p">:</span><span class="n">s_end</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">main</span>
</pre></div>
</div>
<p>In the example above, each thread is responsible for computing 8 elements. The <code class="docutils literal notranslate"><span class="pre">T.copy(...)</span></code> method functions at the block level, and TileLang automatically maps data movement operations to individual threads. This design may resonate more intuitively with CUDA developers. Let us now analyze the CUDA code generated from this implementation.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// N is set to 8192 * 8192 when compiling</span>
<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__launch_bounds__</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">main_kernel</span><span class="p">(</span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="o">*</span><span class="w"> </span><span class="n">__restrict__</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bfloat16_t</span><span class="w"> </span><span class="n">A_register</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="n">bfloat16_t</span><span class="w"> </span><span class="n">B_register</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)));</span>
<span class="w">  </span><span class="n">uint4</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">uint4</span><span class="w"> </span><span class="n">v__1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">B_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">x</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">z</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v_</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="o">+</span><span class="p">((</span><span class="n">nv_bfloat162</span><span class="o">*</span><span class="p">)(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">v__1</span><span class="p">.</span><span class="n">w</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__1</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">C</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((((</span><span class="kt">int</span><span class="p">)</span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">uint4</span><span class="o">*</span><span class="p">)(</span><span class="n">A_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We observed the emergence of two additional registers, <code class="docutils literal notranslate"><span class="pre">A_register</span></code> and <code class="docutils literal notranslate"><span class="pre">B_register</span></code>. However, during the actual computation, these registers are simply reassigned to <code class="docutils literal notranslate"><span class="pre">v_</span></code> and <code class="docutils literal notranslate"><span class="pre">v__1</span></code>, respectively.</p>
<p>To evaluate complexity, one could implement the same elementwise addition operator using CuTe and compare it with the TileLang version. The corresponding CuTe code is provided below:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">=</span><span class="mi">8</span><span class="o">&gt;</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">elementwise_add</span><span class="p">(</span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="n">nv_bfloat16</span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cute</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">make_gmem_ptr</span><span class="p">(</span><span class="n">B</span><span class="p">),</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_C_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_C</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_A_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_A</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">t_B_tile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_tile</span><span class="p">(</span><span class="n">t_B</span><span class="p">,</span><span class="w"> </span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="n">NUM_ELE_PER_THREAD</span><span class="o">&gt;</span><span class="p">{}),</span><span class="w"> </span><span class="n">make_coord</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>

<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_A_tile</span><span class="p">);</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_B_tile</span><span class="p">);</span>
<span class="w">  </span><span class="n">Tensor</span><span class="w"> </span><span class="n">reg_buffer_C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor_like</span><span class="p">(</span><span class="n">t_C_tile</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// LDG. 128</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">t_A_tile</span><span class="p">,</span><span class="w"> </span><span class="n">reg_buffer_A</span><span class="p">);</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">t_B_tile</span><span class="p">,</span><span class="w"> </span><span class="n">reg_buffer_B</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_C_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_C</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_A_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_A</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_B_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat162</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_buffer_B</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Perform vectorized addition</span>
<span class="cp">#pragma unroll</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vec_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">vec_idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">reg_C_vector</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">reg_C_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg_A_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">reg_B_vector</span><span class="p">(</span><span class="n">vec_idx</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">reg_C_flat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recast</span><span class="o">&lt;</span><span class="n">nv_bfloat16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reg_C_vector</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// STG. 128</span>
<span class="w">  </span><span class="n">copy</span><span class="p">(</span><span class="n">reg_C_flat</span><span class="p">,</span><span class="w"> </span><span class="n">t_C_tile</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>This tutorial showcases the implementation of the elementwise addition operator using TileLang, while also comparing various design approaches. TileLang significantly reduces the complexity of CUDA programming, enabling high performance with minimal code. Nevertheless, working with TileLang demands careful attention to specific implementation details. To ensure computational efficiency, it is essential to thoroughly examine the generated CUDA kernels.</p>
<hr class="docutils" />
<p><strong>Reference:</strong></p>
<p>[1] The CuTe code implementation draws inspiration from the techniques discussed in this blog: https://zhuanlan.zhihu.com/p/690703999</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gemv.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">General Matrix-Vector Multiplication (GEMV)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorials/auto_tuning.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Auto-Tuning Techniques for Performance Optimization</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025-2025, Tile Lang Contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ElementWise Operators</a><ul>
<li><a class="reference internal" href="#elementwise-add-in-tilelang">Elementwise add in TileLang</a><ul>
<li><a class="reference internal" href="#how-to-compile-operators-with-dynamic-shapes">How to compile operators with dynamic shapes?</a></li>
<li><a class="reference internal" href="#how-tilelang-addresses-boundary-related-issues">How TileLang addresses boundary-related issues.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-of-tilelang-cuda-and-cute">Comparison of TileLang, CUDA, and CuTe</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=c58fda0c"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>